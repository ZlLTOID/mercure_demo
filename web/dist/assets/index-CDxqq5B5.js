var ge=Object.defineProperty;var he=(t,e,n)=>e in t?ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var V=(t,e,n)=>(he(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function y(){}function oe(t){return t()}function x(){return Object.create(null)}function L(t){t.forEach(oe)}function ue(t){return typeof t=="function"}function T(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let U;function R(t,e){return t===e?!0:(U||(U=document.createElement("a")),U.href=e,t===U.href)}function be(t){return Object.keys(t).length===0}function ye(t,...e){if(t==null){for(const r of e)r(void 0);return y}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function fe(t,e,n){t.$$.on_destroy.push(ye(e,n))}function b(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode&&t.parentNode.removeChild(t)}function $e(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function _(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function k(){return v(" ")}function Z(){return v("")}function P(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function ve(t){return function(e){return e.preventDefault(),t.call(this,e)}}function d(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function we(t){return Array.from(t.childNodes)}function A(t,e){e=""+e,t.data!==e&&(t.data=e)}function C(t,e){t.value=e??""}let I;function B(t){I=t}function ke(){if(!I)throw new Error("Function called outside component initialization");return I}function Se(t){ke().$$.on_mount.push(t)}const N=[],G=[];let q=[];const ee=[],ce=Promise.resolve();let Q=!1;function ae(){Q||(Q=!0,ce.then(de))}function Ee(){return ae(),ce}function X(t){q.push(t)}const W=new Set;let M=0;function de(){if(M!==0)return;const t=I;do{try{for(;M<N.length;){const e=N[M];M++,B(e),Le(e.$$)}}catch(e){throw N.length=0,M=0,e}for(B(null),N.length=0,M=0;G.length;)G.pop()();for(let e=0;e<q.length;e+=1){const n=q[e];W.has(n)||(W.add(n),n())}q.length=0}while(N.length);for(;ee.length;)ee.pop()();Q=!1,W.clear(),B(t)}function Le(t){if(t.fragment!==null){t.update(),L(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}function Oe(t){const e=[],n=[];q.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),q=e}const j=new Set;let S;function me(){S={r:0,c:[],p:S}}function pe(){S.r||L(S.c),S=S.p}function w(t,e){t&&t.i&&(j.delete(t),t.i(e))}function E(t,e,n,r){if(t&&t.o){if(j.has(t))return;j.add(t),S.c.push(()=>{j.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function te(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Y(t){t&&t.c()}function z(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),X(()=>{const o=t.$$.on_mount.map(oe).filter(ue);t.$$.on_destroy?t.$$.on_destroy.push(...o):L(o),t.$$.on_mount=[]}),i.forEach(X)}function F(t,e){const n=t.$$;n.fragment!==null&&(Oe(n.after_update),L(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Me(t,e){t.$$.dirty[0]===-1&&(N.push(t),ae(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function J(t,e,n,r,i,o,l=null,f=[-1]){const s=I;B(t);const u=t.$$={fragment:null,ctx:[],props:o,update:y,not_equal:i,bound:x(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:x(),dirty:f,skip_bound:!1,root:e.target||s.$$.root};l&&l(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(a,g,...$)=>{const h=$.length?$[0]:g;return u.ctx&&i(u.ctx[a],u.ctx[a]=h)&&(!u.skip_bound&&u.bound[a]&&u.bound[a](h),c&&Me(t,a)),g}):[],u.update(),c=!0,L(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const a=we(e.target);u.fragment&&u.fragment.l(a),a.forEach(m)}else u.fragment&&u.fragment.c();e.intro&&w(t.$$.fragment),z(t,e.target,e.anchor),de()}B(s)}class H{constructor(){V(this,"$$");V(this,"$$set")}$destroy(){F(this,1),this.$destroy=y}$on(e,n){if(!ue(n))return y;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!be(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const De="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(De);const D=[];function _e(t,e=y){let n;const r=new Set;function i(f){if(T(t,f)&&(t=f,n)){const s=!D.length;for(const u of r)u[1](),D.push(u,t);if(s){for(let u=0;u<D.length;u+=2)D[u][0](D[u+1]);D.length=0}}}function o(f){i(f(t))}function l(f,s=y){const u=[f,s];return r.add(u),r.size===1&&(n=e(i,o)||y),f(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}const K=_e(null),Ne=[{id:1,name:"Alice",email:"alice@example.com",password:"1"},{id:2,name:"Bob",email:"bob@example.com",password:"2"}];function Ce(t,e){const n=Ne.find(r=>r.email===t&&r.password===e);return n?(K.set(n),!0):!1}function Pe(){K.set(null)}function ne(t){let e;function n(o,l){return o[0].myMessage===!0?Ae:qe}let r=n(t),i=r(t);return{c(){i.c(),e=Z()},m(o,l){i.m(o,l),p(o,e,l)},p(o,l){r===(r=n(o))&&i?i.p(o,l):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&m(e),i.d(o)}}}function qe(t){let e,n,r,i,o;function l(u,c){if(u[0].img)return Te;if(u[0].message)return Ie;if(u[0].binary)return Be}let f=l(t),s=f&&f(t);return{c(){e=_("div"),n=_("div"),r=_("div"),s&&s.c(),i=k(),o=_("div"),o.textContent=" ",d(r,"class","theirMsg svelte-1yyfo95"),d(n,"class","theirMsgRow svelte-1yyfo95"),d(e,"class","msg svelte-1yyfo95")},m(u,c){p(u,e,c),b(e,n),b(n,r),s&&s.m(r,null),b(n,i),b(n,o)},p(u,c){f===(f=l(u))&&s?s.p(u,c):(s&&s.d(1),s=f&&f(u),s&&(s.c(),s.m(r,null)))},d(u){u&&m(e),s&&s.d()}}}function Ae(t){let e,n,r,i,o;function l(u,c){if(u[0].img)return Re;if(u[0].message)return je;if(u[0].binary)return Ue}let f=l(t),s=f&&f(t);return{c(){e=_("div"),n=_("div"),r=_("div"),s&&s.c(),i=k(),o=_("div"),o.textContent=" ",d(r,"class","myMsg svelte-1yyfo95"),d(n,"class","myMsgRow svelte-1yyfo95"),d(e,"class","msg svelte-1yyfo95")},m(u,c){p(u,e,c),b(e,n),b(n,r),s&&s.m(r,null),b(n,i),b(n,o)},p(u,c){f===(f=l(u))&&s?s.p(u,c):(s&&s.d(1),s=f&&f(u),s&&(s.c(),s.m(r,null)))},d(u){u&&m(e),s&&s.d()}}}function Be(t){let e,n,r=t[0].filename+"",i,o,l;return{c(){e=v("Download  "),n=_("a"),i=v(r),d(n,"download",o=t[0].filename),d(n,"href",l=t[0].binary)},m(f,s){p(f,e,s),p(f,n,s),b(n,i)},p(f,s){s&1&&r!==(r=f[0].filename+"")&&A(i,r),s&1&&o!==(o=f[0].filename)&&d(n,"download",o),s&1&&l!==(l=f[0].binary)&&d(n,"href",l)},d(f){f&&(m(e),m(n))}}}function Ie(t){let e=t[0].message+"",n;return{c(){n=v(e)},m(r,i){p(r,n,i)},p(r,i){i&1&&e!==(e=r[0].message+"")&&A(n,e)},d(r){r&&m(n)}}}function Te(t){let e,n;return{c(){e=_("img"),R(e.src,n=t[0].img)||d(e,"src",n),d(e,"alt","imagery"),d(e,"class","svelte-1yyfo95")},m(r,i){p(r,e,i)},p(r,i){i&1&&!R(e.src,n=r[0].img)&&d(e,"src",n)},d(r){r&&m(e)}}}function Ue(t){let e,n,r=t[0].filename+"",i,o,l;return{c(){e=v("Download  "),n=_("a"),i=v(r),d(n,"download",o=t[0].filename),d(n,"href",l=t[0].binary)},m(f,s){p(f,e,s),p(f,n,s),b(n,i)},p(f,s){s&1&&r!==(r=f[0].filename+"")&&A(i,r),s&1&&o!==(o=f[0].filename)&&d(n,"download",o),s&1&&l!==(l=f[0].binary)&&d(n,"href",l)},d(f){f&&(m(e),m(n))}}}function je(t){let e=t[0].message+"",n;return{c(){n=v(e)},m(r,i){p(r,n,i)},p(r,i){i&1&&e!==(e=r[0].message+"")&&A(n,e)},d(r){r&&m(n)}}}function Re(t){let e,n;return{c(){e=_("img"),R(e.src,n=t[0].img)||d(e,"src",n),d(e,"alt","imagery"),d(e,"class","svelte-1yyfo95")},m(r,i){p(r,e,i)},p(r,i){i&1&&!R(e.src,n=r[0].img)&&d(e,"src",n)},d(r){r&&m(e)}}}function ze(t){let e,n=t[0].isDisplayable&&ne(t);return{c(){e=_("div"),n&&n.c()},m(r,i){p(r,e,i),n&&n.m(e,null)},p(r,[i]){r[0].isDisplayable?n?n.p(r,i):(n=ne(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:y,o:y,d(r){r&&m(e),n&&n.d()}}}function Fe(t,e,n){let{msg:r}=e;return t.$$set=i=>{"msg"in i&&n(0,r=i.msg)},[r]}class Je extends H{constructor(e){super(),J(this,e,Fe,ze,T,{msg:0})}}function re(t,e,n){const r=t.slice();return r[4]=e[n],r}function He(t){let e;return{c(){e=v("No messages yet.")},m(n,r){p(n,e,r)},p:y,i:y,o:y,d(n){n&&m(e)}}}function Ke(t){let e,n,r=te(t[0]),i=[];for(let l=0;l<r.length;l+=1)i[l]=ie(re(t,r,l));const o=l=>E(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=Z()},m(l,f){for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(l,f);p(l,e,f),n=!0},p(l,f){if(f&1){r=te(l[0]);let s;for(s=0;s<r.length;s+=1){const u=re(l,r,s);i[s]?(i[s].p(u,f),w(i[s],1)):(i[s]=ie(u),i[s].c(),w(i[s],1),i[s].m(e.parentNode,e))}for(me(),s=r.length;s<i.length;s+=1)o(s);pe()}},i(l){if(!n){for(let f=0;f<r.length;f+=1)w(i[f]);n=!0}},o(l){i=i.filter(Boolean);for(let f=0;f<i.length;f+=1)E(i[f]);n=!1},d(l){l&&m(e),$e(i,l)}}}function ie(t){let e,n;return e=new Je({props:{msg:t[4]}}),{c(){Y(e.$$.fragment)},m(r,i){z(e,r,i),n=!0},p(r,i){const o={};i&1&&(o.msg=r[4]),e.$set(o)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){E(e.$$.fragment,r),n=!1},d(r){F(e,r)}}}function Ve(t){let e,n,r,i;const o=[Ke,He],l=[];function f(s,u){var c;return(c=s[0])!=null&&c.length?0:1}return n=f(t),r=l[n]=o[n](t),{c(){e=_("div"),r.c(),d(e,"class","msgLogContent svelte-m4rob")},m(s,u){p(s,e,u),l[n].m(e,null),t[3](e),i=!0},p(s,[u]){let c=n;n=f(s),n===c?l[n].p(s,u):(me(),E(l[c],1,1,()=>{l[c]=null}),pe(),r=l[n],r?r.p(s,u):(r=l[n]=o[n](s),r.c()),w(r,1),r.m(e,null))},i(s){i||(w(r),i=!0)},o(s){E(r),i=!1},d(s){s&&m(e),l[n].d(),t[3](null)}}}function We(t,e,n){let{messages:r=[]}=e,i;Se(()=>{o()});async function o(){i&&(await Ee(),i.scroll(0,i.scrollHeight+50))}function l(f){G[f?"unshift":"push"](()=>{i=f,n(1,i)})}return t.$$set=f=>{"messages"in f&&n(0,r=f.messages)},t.$$.update=()=>{t.$$.dirty&1&&(r.length,o())},[r,i,o,l]}class Ge extends H{constructor(e){super(),J(this,e,We,Ve,T,{messages:0,scrollToBottom:2})}get scrollToBottom(){return this.$$.ctx[2]}}new Date().toISOString().substring(11,16);const se=_e([]);function Qe(t){let e,n,r,i,o,l,f,s,u,c,a=t[3]&&le(t);return{c(){e=_("form"),n=_("input"),r=k(),i=_("input"),o=k(),l=_("button"),l.textContent="Login",f=k(),a&&a.c(),s=Z(),d(n,"type","email"),d(n,"placeholder","Email"),n.required=!0,d(i,"type","password"),d(i,"placeholder","Password"),i.required=!0,d(l,"type","submit")},m(g,$){p(g,e,$),b(e,n),C(n,t[1]),b(e,r),b(e,i),C(i,t[2]),b(e,o),b(e,l),p(g,f,$),a&&a.m(g,$),p(g,s,$),u||(c=[P(n,"input",t[6]),P(i,"input",t[7]),P(e,"submit",ve(t[4]))],u=!0)},p(g,$){$&2&&n.value!==g[1]&&C(n,g[1]),$&4&&i.value!==g[2]&&C(i,g[2]),g[3]?a?a.p(g,$):(a=le(g),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},d(g){g&&(m(e),m(f),m(s)),a&&a.d(g),u=!1,L(c)}}}function Xe(t){let e,n,r=t[0].name+"",i,o,l,f,s,u;return{c(){e=_("p"),n=v("Welcome, "),i=v(r),o=v("!"),l=k(),f=_("button"),f.textContent="Logout"},m(c,a){p(c,e,a),b(e,n),b(e,i),b(e,o),p(c,l,a),p(c,f,a),s||(u=P(f,"click",t[5]),s=!0)},p(c,a){a&1&&r!==(r=c[0].name+"")&&A(i,r)},d(c){c&&(m(e),m(l),m(f)),s=!1,u()}}}function le(t){let e,n;return{c(){e=_("p"),n=v(t[3])},m(r,i){p(r,e,i),b(e,n)},p(r,i){i&8&&A(n,r[3])},d(r){r&&m(e)}}}function Ye(t){let e;function n(o,l){return o[0]?Xe:Qe}let r=n(t),i=r(t);return{c(){e=_("div"),i.c(),d(e,"class","login svelte-1e6ryvy")},m(o,l){p(o,e,l),i.m(e,null)},p(o,[l]){r===(r=n(o))&&i?i.p(o,l):(i.d(1),i=r(o),i&&(i.c(),i.m(e,null)))},i:y,o:y,d(o){o&&m(e),i.d()}}}function Ze(t,e,n){let r;fe(t,K,a=>n(0,r=a));let i="",o="",l="";function f(){Ce(i,o)?n(3,l=""):n(3,l="Invalid credentials")}function s(){Pe()}function u(){i=this.value,n(1,i)}function c(){o=this.value,n(2,o)}return t.$$.update=()=>{t.$$.dirty&1},[r,i,o,l,f,s,u,c]}class xe extends H{constructor(e){super(),J(this,e,Ze,Ye,T,{})}}function et(t){let e,n,r,i,o,l,f,s;return e=new xe({}),r=new Ge({props:{messages:t[0]}}),{c(){Y(e.$$.fragment),n=k(),Y(r.$$.fragment),i=k(),o=_("input")},m(u,c){z(e,u,c),p(u,n,c),z(r,u,c),p(u,i,c),p(u,o,c),C(o,t[1]),l=!0,f||(s=[P(o,"input",t[3]),P(o,"change",t[2])],f=!0)},p(u,[c]){const a={};c&1&&(a.messages=u[0]),r.$set(a),c&2&&o.value!==u[1]&&C(o,u[1])},i(u){l||(w(e.$$.fragment,u),w(r.$$.fragment,u),l=!0)},o(u){E(e.$$.fragment,u),E(r.$$.fragment,u),l=!1},d(u){u&&(m(n),m(i),m(o)),F(e,u),F(r,u),f=!1,L(s)}}}const tt="localhost";function nt(t,e,n){let r;fe(t,K,h=>n(5,r=h));let i=new Date().toISOString().substring(11,16);new Date().toISOString().substring(0,10);let o=[];se.subscribe(h=>{n(0,o=h)});let l="";async function f(){const O=await await fetch("http://localhost:8000/send-message",{method:"POST",body:JSON.stringify({user:r,message:l})});console.log(O.status)}function s(){f();let h={message:l,isDisplayable:!0,strDate:i,from:r.name,myMessage:!0,time:new Date().getTime()};u(h),console.log(h),n(1,l="")}function u(h){se.update(O=>[...O,h])}const c=new URL("https://"+tt+"/.well-known/mercure");c.searchParams.append("topic","https://seymour.ch/conversation/1");const a=new EventSource(c);a.onmessage=h=>g(JSON.parse(h.data));function g(h){console.log(h.user.name);let O={message:h.message,isDisplayable:!0,strDate:i,from:h.user,myMessage:!1,time:new Date().getTime()};console.log(O),console.log(h.user),r.name!=h.user.name&&u(O),n(1,l="")}function $(){l=this.value,n(1,l)}return[o,l,s,$]}class rt extends H{constructor(e){super(),J(this,e,nt,et,T,{})}}new rt({target:document.getElementById("app")});
